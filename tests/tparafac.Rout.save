
R Under development (unstable) (2017-06-16 r72802) -- "Unsuffered Consequences"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ## this will render the output independent from the version of the package
> suppressPackageStartupMessages(library(rrcov3way))
> 
> 
> ## Example with the UNIDO Manufacturing value added data
> data(va3way)
> dim(va3way)
[1] 55  5 11
> 
> ## Treat quickly and dirty the zeros in the data set (if any)
> va3way[va3way==0] <- 0.001
> 
> (res <- Parafac(va3way))
Call:
Parafac(X = va3way)


PARAFAC analysis with  2  components.
Fit value: 97.07 %
> print(res$fit)
[1] 1.212583e+23
> ## These seem to show differences in i386 architecture
> ##  comment it out
> ##print(res$A)
> ##print(res$B)
> ##print(res$C)
> print(res$rd)
         ALB          AUS          AUT          BWA          BRA          BGR 
   271141433  53199561336  10194484928    974779684  58196905389   1913025515 
         CAN          COL          CRI          CYP          CZE          DNK 
 71966604812  12313268670   2786538034   1395535195  10559616982  11795416603 
         ERI          EST          FJI          FIN          FRA          GEO 
    94353078   1150379870    567168532  22745540884  61756247965    268447944 
         PSE          DEU          HKG          HUN          IND          IDN 
   681444256 230060312967   7633809417   7941165538  51117088564  42589542006 
         IRN          IRL          ISR          ITA          JPN          JOR 
 31584444413  28301362663  17392170399  58080937126 149434684702   1210474338 
         KEN          KWT          LVA          LTU          LUX          MAC 
  1590069603   7046229736   1923452017   2298464531   4397179709    688986999 
         MYS          MUS          MEX          MAR          OMN          NLD 
 27982738347   1906111417  36805089941   5152044069   5522796738  18507953609 
         NZL          NOR          PRT          QAT          ROU          SGP 
 10341255049  12918272310  13954728981   8895169942   6917938100  35237462548 
         SVK          SVN          ZAF          ESP          SWE          TUN 
  3455100264   2400346663  18550977731  53409277810  19518369330  11974473525 
         GBR 
107367156951 
> print(res$cutoff.rd)
[1] 98433727803
> 
> (res.r <- Parafac(va3way, robust=TRUE))
[1] 1
[1] 2
[1] 3
Call:
Parafac(X = va3way, robust = TRUE)


PARAFAC analysis with  2  components.
Fit value: 98.6 %
Robust> print(res.r$fit)
[1] 3.296598e+21
> print(res.r$A)
              F1           F2
ALB 4.613856e+08    384289992
AUS 9.656811e+10  68089073250
AUT 8.596897e+10  28365415203
BWA 3.572470e+08    194438529
BRA 3.943414e+11 180196058546
BGR 6.390231e+09   3470988017
CAN 2.687289e+11 105500205795
COL 3.708307e+10  25967239973
CRI 4.478257e+09   2895165872
CYP 2.101361e+09   1871608583
CZE 5.061941e+10  18440696797
DNK 5.071501e+10  11610483041
ERI 7.630079e+07     51070066
EST 2.967806e+09   1698966646
FJI 4.341371e+08    303923967
FIN 5.469051e+10  12483564695
FRA 4.107507e+11  94196245420
GEO 4.436722e+08    331536563
PSE 9.429481e+08    921946861
DEU 9.640425e+11  83290089817
HKG 8.563799e+09   2139834736
HUN 3.430491e+10   6136517757
IND 1.656008e+11  85368708866
IDN 8.671235e+10  30191534495
IRN 6.160260e+10  28061237013
IRL 6.949580e+10 -10968995990
ISR 2.962779e+10   1332334819
ITA 4.208767e+11 170233088870
JPN 1.472613e+12 247099649185
JOR 4.697912e+09   2995759313
KEN 2.908932e+09   2657584202
KWT 7.993915e+09   8460076736
LVA 2.585771e+09   1625654509
LTU 4.240785e+09   2514858864
LUX 3.797658e+09   4156662862
MAC 3.839014e+08    295720610
MYS 5.430419e+10  20599414316
MUS 1.577748e+09   1324229319
MEX 1.530317e+11  55168542782
MAR 1.233043e+10   6755544311
OMN 5.315707e+09   6262313619
NLD 1.155901e+11  30772831994
NZL 1.727192e+10  12807104998
NOR 3.725579e+10  10330568639
PRT 3.291092e+10  19457395374
QAT 9.039367e+09   8434016784
ROU 2.119499e+10  10844754940
SGP 4.423935e+10 -15381982546
SVK 1.140508e+10   4291890730
SVN 1.257299e+10   4002183385
ZAF 5.601767e+10  38392378183
ESP 2.361851e+11 121480061208
SWE 9.968695e+10  13642787585
TUN 1.113850e+10   5921907520
GBR 3.739891e+11  82115378444
> print(res.r$B)
              F1          F2
LAGRO -0.3924692 -0.24403997
LNAGR -0.1664441 -0.02618719
MLOW  -0.2755446 -0.74561496
MHIGH -0.8039252  0.48239869
HIGH  -0.3099093  0.38872685
> print(res.r$C)
             F1         F2
2000 -0.2129453 -0.2075823
2001 -0.2057994 -0.2052425
2002 -0.2197792 -0.2227891
2003 -0.2650207 -0.2723322
2004 -0.3014914 -0.3190088
2005 -0.3087511 -0.3294822
2006 -0.3270456 -0.3430701
2007 -0.3809441 -0.4037603
2008 -0.3858980 -0.3832169
2009 -0.3075899 -0.2752409
2010 -0.3345618 -0.2780789
> print(res.r$rd)
         ALB          AUS          AUT          BWA          BRA          BGR 
   352264142  35977741579  11765822433    972545197 140978886560   2747343718 
         CAN          COL          CRI          CYP          CZE          DNK 
 64327861291  16006828627   3098885244   1224462977  13304859428  10268302284 
         ERI          EST          FJI          FIN          FRA          GEO 
    93548732   1400030541    577012494  20207416561  43024031681    374913363 
         PSE          DEU          HKG          HUN          IND          IDN 
   636165255 245320736365   7397548488   7733809030  70365903430  51676673776 
         IRN          IRL          ISR          ITA          JPN          JOR 
 34481060821  12740191951  15993811405  21038574073 372656010051   1970907602 
         KEN          KWT          LVA          LTU          LUX          MAC 
  1626711644   4965397322   1965032424   2397061476   3086814901    678460171 
         MYS          MUS          MEX          MAR          OMN          NLD 
 28040986658   2008296570  45278939480   6155522440   4793212937  12924534002 
         NZL          NOR          PRT          QAT          ROU          SGP 
 10762618693  11208261857  11992152461   9165241872   8080240327  30535420540 
         SVK          SVN          ZAF          ESP          SWE          TUN 
  4665928682   2678619414   8160902737  17687093578  14995111859  12374470986 
         GBR 
 93904073788 
> print(res$cutoff.rd)
[1] 98433727803
> print(res.r$Hset)
 [1]  1  3  4  6  8  9 10 11 12 13 14 15 16 18 19 21 22 26 27 28 30 31 32 33 34
[26] 35 36 38 40 41 42 43 44 45 46 47 49 50 51 53 54
> print(res.r$flag)
  ALB   AUS   AUT   BWA   BRA   BGR   CAN   COL   CRI   CYP   CZE   DNK   ERI 
 TRUE FALSE  TRUE  TRUE FALSE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE 
  EST   FJI   FIN   FRA   GEO   PSE   DEU   HKG   HUN   IND   IDN   IRN   IRL 
 TRUE  TRUE  TRUE FALSE  TRUE  TRUE FALSE  TRUE  TRUE FALSE FALSE FALSE  TRUE 
  ISR   ITA   JPN   JOR   KEN   KWT   LVA   LTU   LUX   MAC   MYS   MUS   MEX 
 TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE 
  MAR   OMN   NLD   NZL   NOR   PRT   QAT   ROU   SGP   SVK   SVN   ZAF   ESP 
 TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE 
  SWE   TUN   GBR 
 TRUE  TRUE FALSE 
> 
> (res.c <- Parafac(va3way, ilr=TRUE))
Call:
Parafac(X = va3way, ilr = TRUE)


PARAFAC analysis with  2  components.
Fit value: 75.23 %
ilr-transformed
> print(res.c$fit)
[1] 6690.137
> print(res.c$A)
            F1          F2
ALB  9.1487863   3.0878433
AUS  4.8289813   2.4634162
AUT  3.9365385   2.3322591
BWA 39.2074366 -13.1907518
BRA  6.0387289   3.4014661
BGR  7.3002555   3.1267679
CAN  3.8858163   2.3631355
COL 12.8968983   4.7174937
CRI 22.8710772   7.0560345
CYP 13.7481634   3.4742167
CZE  5.1289959   3.0966152
DNK  3.4877980   1.8308181
ERI 39.4665531   9.6962407
EST  6.1806492   1.6695850
FJI 24.8791603   6.0102192
FIN  0.0740469   1.1124068
FRA  2.1710300   1.9179019
GEO  5.9821602   2.3147909
PSE 21.0534401   5.4630432
DEU  2.4291798   2.5687203
HKG  3.8053552  11.3044571
HUN  2.3023622   2.6069983
IND  5.3657237   4.0502333
IDN  4.1203672   2.6042659
IRN  7.4826945   5.7664792
IRL -0.9246309   0.3788621
ISR -2.2813923   0.5241492
ITA  4.6648074   2.5102740
JPN  1.3966036   2.1296942
JOR 15.0681093   5.2927268
KEN 75.9907515  21.2715590
KWT 21.0794611   7.5405397
LVA  6.5541807   1.5610596
LTU  5.1741983   1.3616452
LUX 19.0571388   7.1779590
MAC 62.6725517   1.5041998
MYS -0.8539584   1.4722236
MUS 14.1489732   2.4861355
MEX  9.5891311   5.3957611
MAR 10.6309367   4.8151571
OMN 16.0848663   6.4160585
NLD  3.5123954   1.8985070
NZL 26.9181427   2.6011118
NOR  1.1657063   0.9118409
PRT  7.0018329   2.4833060
QAT 24.3766174   8.8122344
ROU  5.8135216   2.4220778
SGP -6.8917968   0.2705279
SVK  4.6215235   3.0244659
SVN  5.6015545   2.9080585
ZAF  9.6961158   3.4390557
ESP  6.4905493   2.8974224
SWE  2.2786798   2.0360797
TUN 76.0751586  33.5425303
GBR  1.3977130   1.0554738
> print(res.c$B)
              F1          F2
[1,]  0.02392883  0.64800767
[2,] -0.39364719 -1.12458248
[3,] -0.60602513 -1.21704383
[4,] -0.72222252 -0.06705517
> print(res.c$Bclr)
               F1          F2
LAGRO -0.48022381 -0.36722254
LNAGR -0.51406428 -1.28364378
MLOW  -0.01502666  0.55189346
MHIGH  0.36333929  1.03899688
HIGH   0.64597546  0.05997597
> print(res.c$C)
             F1        F2
2000 -0.3166719 0.4369684
2001 -0.3146414 0.4337140
2002 -0.2913660 0.4133999
2003 -0.2670238 0.4015189
2004 -0.2691014 0.4032482
2005 -0.2988287 0.4699572
2006 -0.3003990 0.4744419
2007 -0.2562942 0.3464096
2008 -0.2995392 0.3656590
2009 -0.3117801 0.3726502
2010 -0.3120717 0.3752528
> print(res.c$rd)
       ALB        AUS        AUT        BWA        BRA        BGR        CAN 
 5.1488877  3.5780977  1.1299946 21.6617181  2.1778998  2.1889893  2.3488804 
       COL        CRI        CYP        CZE        DNK        ERI        EST 
 1.6612543  3.4477507  2.9163859  1.1038301  2.0414730 21.3053652  2.2386079 
       FJI        FIN        FRA        GEO        PSE        DEU        HKG 
16.1783011  2.6715219  1.4928101  4.4220592  2.4312550  1.7160248 37.9960585 
       HUN        IND        IDN        IRN        IRL        ISR        ITA 
 1.7940404  2.2408052  4.6657249  2.3720646  4.7928914  2.1431795  0.9974742 
       JPN        JOR        KEN        KWT        LVA        LTU        LUX 
 1.2192858  2.6891165 16.8675036 20.7424347  3.2724402  2.8452867 19.9696862 
       MAC        MYS        MUS        MEX        MAR        OMN        NLD 
23.3469404  2.8184709  4.4228270  3.8021010  3.5626085  5.6804718  1.5544847 
       NZL        NOR        PRT        QAT        ROU        SGP        SVK 
33.5154189  1.8469779  1.9740060  9.2176076  2.4010645  1.5074157  1.4735314 
       SVN        ZAF        ESP        SWE        TUN        GBR 
 1.9053529  1.2169441  1.1263120  2.0659235 29.2498824  1.7117411 
> print(res$cutoff.rd)
[1] 98433727803
> 
> (res.rc <- Parafac(va3way, robust=TRUE, ilr=TRUE))
[1] 1
[1] 2
[1] 3
Call:
Parafac(X = va3way, robust = TRUE, ilr = TRUE)


PARAFAC analysis with  2  components.
Fit value: 91.17 %
Robust, ilr-transformed
> print(res.rc$fit)
[1] 178.4675
> print(res.rc$A)
             F1          F2
ALB  -6.7795482   2.7212812
AUS  -3.1618585   3.4010171
AUT  -2.0841442   3.3997327
BWA -41.3426391 -49.9348431
BRA  -3.5248072   5.0516861
BGR  -4.7205823   3.6466480
CAN  -2.2061978   3.7739059
COL  -8.6611222   4.1345387
CRI -15.7159202   4.0507100
CYP -10.2062736   0.6903165
CZE  -2.6964224   4.5094375
DNK  -1.9413098   2.5414879
ERI -27.5340599   0.4115876
EST  -4.6321018   0.8829120
FJI -17.7851137   0.5123080
FIN   0.3392786   3.0641217
FRA  -0.8602320   3.5738578
GEO  -4.3434940   2.6209814
PSE -15.2465299   0.8728935
DEU  -0.5252196   4.7718930
HKG   0.5505557  30.3511372
HUN  -0.6099169   5.1809823
IND  -2.6188087   6.8459110
IDN  -2.4729439   4.7398655
IRN  -3.4530354   9.6733607
IRL   1.2560547   1.9459138
ISR   2.0599836   2.9083384
ITA  -2.6864220   3.4545256
JPN  -0.0329052   4.4413631
JOR -10.1735052   4.1363532
KEN -52.3605354   6.2243866
KWT -13.3975331   5.0435513
LVA  -5.1410265   0.6850431
LTU  -3.9789828   0.7300826
LUX -11.7532466   5.8327120
MAC -55.7759636 -32.5906705
MYS   1.2612941   4.1943791
MUS -11.4331085  -1.5738552
MEX  -5.4408494   7.9593725
MAR  -6.8530611   6.0603250
OMN -10.4923287   5.6695417
NLD  -1.9772239   2.7619195
NZL -22.5596229  -7.9555066
NOR  -0.6237709   1.8399424
PRT  -4.8276981   2.2435930
QAT -15.8670706   6.1243452
ROU  -3.9063555   2.8862018
SGP   6.2799556   4.4438512
SVK  -2.3771447   4.6115478
SVN  -3.1208156   3.8252749
ZAF  -6.4456705   2.5586766
ESP  -4.0489436   3.2793738
SWE  -0.8058628   3.7852741
TUN -45.9275804  34.3862011
GBR  -0.6056048   1.8510175
> print(res.rc$B)
             F1         F2
[1,] 0.34055811  0.5717774
[2,] 0.01928598 -0.5164975
[3,] 0.34651833 -0.6241222
[4,] 0.87382680  0.1295084
> print(res.rc$Bclr)
               F1          F2
LAGRO  0.54410925  0.04223881
LNAGR  0.06248736 -0.76637650
MLOW   0.27967790  0.27050885
MHIGH -0.10470007  0.56946464
HIGH  -0.78157445 -0.11583580
> print(res.rc$C)
             F1        F2
2000 -0.3139767 0.2720255
2001 -0.3034104 0.2733849
2002 -0.3107147 0.2678146
2003 -0.2964218 0.2777710
2004 -0.3122599 0.2974262
2005 -0.3023599 0.2992889
2006 -0.3061783 0.3062573
2007 -0.2992383 0.3200756
2008 -0.2858372 0.3288387
2009 -0.2918773 0.3241537
2010 -0.2929837 0.3389584
> print(res.rc$rd)
       ALB        AUS        AUT        BWA        BRA        BGR        CAN 
 4.0861890  3.0372045  1.1791005 29.3994346  0.7677991  1.3637133  1.6341021 
       COL        CRI        CYP        CZE        DNK        ERI        EST 
 1.1207953  4.6399874  2.2636848  1.3729549  1.9830296 23.2756391  1.6302172 
       FJI        FIN        FRA        GEO        PSE        DEU        HKG 
16.7856919  2.1908735  0.8939873  3.6832673  3.1335033  1.8866363 33.8788326 
       HUN        IND        IDN        IRN        IRL        ISR        ITA 
 0.9515798  1.3580104  3.5645748  1.9175907  4.5668689  1.9029341  0.7013484 
       JPN        JOR        KEN        KWT        LVA        LTU        LUX 
 0.7129805  2.8972398 23.5242039 21.6452357  2.6018911  2.3851718 20.7415587 
       MAC        MYS        MUS        MEX        MAR        OMN        NLD 
17.2222948  2.6859912  3.1289420  2.6051346  1.6275423  6.3698804  1.2279324 
       NZL        NOR        PRT        QAT        ROU        SGP        SVK 
33.3700628  1.4787756  1.3069775 11.0409635  1.4716039  1.2948120  1.5682160 
       SVN        ZAF        ESP        SWE        TUN        GBR 
 2.1558707  2.0578894  1.1768773  1.7410520 35.8944576  1.6080668 
> print(res$cutoff.rd)
[1] 98433727803
> print(res.rc$Hset)
 [1]  1  2  3  5  6  7  8 10 11 12 14 16 17 18 19 20 22 23 24 25 27 28 29 30 33
[26] 34 37 38 39 40 42 44 45 47 48 49 50 51 52 53 55
> print(res.rc$flag)
  ALB   AUS   AUT   BWA   BRA   BGR   CAN   COL   CRI   CYP   CZE   DNK   ERI 
 TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE FALSE 
  EST   FJI   FIN   FRA   GEO   PSE   DEU   HKG   HUN   IND   IDN   IRN   IRL 
 TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE FALSE 
  ISR   ITA   JPN   JOR   KEN   KWT   LVA   LTU   LUX   MAC   MYS   MUS   MEX 
 TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE 
  MAR   OMN   NLD   NZL   NOR   PRT   QAT   ROU   SGP   SVK   SVN   ZAF   ESP 
 TRUE FALSE  TRUE FALSE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE 
  SWE   TUN   GBR 
 TRUE FALSE  TRUE 
> 
> proc.time()
   user  system elapsed 
   5.10    0.06    5.14 
